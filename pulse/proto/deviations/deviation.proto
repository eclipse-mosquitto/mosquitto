syntax = "proto3";

package hivemq.pulse.grpc;

option java_multiple_files = true;
option java_package = "com.hivemq.pulse.agent.server.communication.message.proto";

import "uuid.proto";
import "google/protobuf/timestamp.proto";

message DeviationProto {
  UuidProto deviation_id = 1;
  UuidProto node_id = 2;
  Type deviation_type = 3;
  string field_selector = 4;
  /**
    optional field, may be null if the deviation_type is UNEXPECTED_FIELD, otherwise not-null
   */
  optional string data_type = 5;
  int32 count = 6;
  google.protobuf.Timestamp last_occurrence = 7;

  enum Type {
    MISSING_FIELD = 0;
    UNEXPECTED_FIELD = 1;
    UNEXPECTED_FORMAT = 2;
  }
}


